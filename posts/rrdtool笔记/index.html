<!DOCTYPE html>
<html lang="en"><meta charset="utf-8"><meta name="generator" content="Hugo 0.87.0" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark"><title>Centos6 rrdtool环境配置&nbsp;&ndash;&nbsp;比克王国</title><link rel="stylesheet" href="/css/core.min.ce377468f8d4eea57a095f8d4581a56bae44d81643a42e5e1ae36b10a2a1eb4e3fcd37985f285ccc586eb563916c2d3a.css" integrity="sha384-zjd0aPjU7qV6CV&#43;NRYGla65E2BZDpC5eGuNrEKKh604/zTeYXyhczFhutWORbC06"><meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Centos6 rrdtool环境配置" /><body><section id="header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/"><span class="site name">比克王国</span></a></span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/categories/">Categories</a><a class="nav item" href="/tags/">Tags</a></nav></div></span></div></section><section id="content"><div class="article-container"><section class="article header">
    <h1 class="article title">Centos6 rrdtool环境配置</h1><p class="article date">2016-04-09</p></section><article class="article markdown-body"><p>首先是rrdtool这个工具的介绍：
<a href="http://zhaochj.blog.51cto.com/368705/1657026"target="_blank" rel="noopener noreferrer">rrd比较好的介绍</a>
以及
<a href="http://qushouxichuan.com/blog/article/60"target="_blank" rel="noopener noreferrer">rrdtool的python实例</a>
</p>
<p>其次，怎样才能把rrdtool生成的图弄得漂亮一些呢，默认的图太丑太不fashion了。</p>
<h4 id="centos上安装rrdtool">CentOS上安装rrdtool</h4>
<p>正常情况下，当然是用yum安装:</p>
<pre><code>yum install rrdtool rrdtool-devel
</code></pre><p>然后</p>
<pre><code>pip install rrdtool
</code></pre><p>由于网管系统是基于Python2.7开发的，centos6.5默认的python版本是2.6.6，手动升级到python2.7之后，再安装rrdtool的python支持（<code>pip install rrdtool</code>), 在python使用，就会报错。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#f92672">import</span> rrdtool
Traceback (most recent call last):
 File <span style="color:#e6db74">&#34;&lt;stdin&gt;&#34;</span>, line <span style="color:#ae81ff">1</span>, <span style="color:#f92672">in</span> <span style="color:#f92672">&lt;</span>module<span style="color:#f92672">&gt;</span>
<span style="color:#a6e22e">ImportError</span>: <span style="color:#f92672">/</span>usr<span style="color:#f92672">/</span>local<span style="color:#f92672">/</span>lib<span style="color:#f92672">/</span>python2<span style="color:#ae81ff">.7</span><span style="color:#f92672">/</span>site<span style="color:#f92672">-</span>packages<span style="color:#f92672">/</span>rrdtoolmodule<span style="color:#f92672">.</span>so: undefined symbol: rrd_flushcached
</code></pre></div><p>解决方案是：用rrdtool源码重新编译安装rrdtool（而不是通过yum源去安装rpm包）。</p>
<pre><code>#由于rrdtool官网有时候会连不上，而且centos默认的rrdtool版本是1.3.8，所有我就自建下载地址
wget http://oss.oetiker.ch/rrdtool/pub/rrdtool-1.3.8.tar.gz
tar zxvf rrdtool-1.3.8.tar.gz
cd rrdtool-1.3.8
yum install -y libxml pango*
./configure --prefix=/usr/local
make
make install

# 安装rrdtool-python
pip install rrdtool
</code></pre><p>安装后如果遇到下面这个问题：</p>
<pre><code>&gt;&gt;&gt; import rrdtool
Traceback (most recent call last):
  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
ImportError: librrd.so.4: cannot open shared object file: No such file or directory
&gt;&gt;&gt;

</code></pre><p>解决办法是将rrdtool库做软链接到/usr/lib</p>
<pre><code>ln -s /usr/local/lib/librrd* /usr/lib
ldconfig
</code></pre><h5 id="安装rrdtool-php">安装rrdtool-php</h5>
<p>环境：php版本5.3.3，rrdtool版本1.3.8</p>
<pre><code>wget https://pecl.php.net/get/rrd-1.1.3.tgz
tar xvf rrd-1.1.3.tgz
cd rrd-1.1.3
phpize # 是用来扩展php扩展模块的，通过phpize可以建立php的外挂模块
./configure
make
make install
</code></pre><p>在/etc/php.d/里添加rrd.ini，仿照其他的ini文件，填上内容。重启httpd服务，完事。
哦， 不对，<code>php -m</code>看一下rrd模块加载进去没，如果有rrd则完事。</p>
<p>附录：<a href="https://www.phparch.com/2011/02/creating-rrd-graphs-in-php/"target="_blank" rel="noopener noreferrer">php的rrdtool教程</a>
</p>
</article><section class="article labels"><a class="category" href=/categories/tools/>tools</a></section>
</div>
<div class="article bottom"><section class="article navigation"><p><a class="link" href="/posts/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B%E5%AD%A6%E4%B9%A0/"><span class="iconfont icon-article"></span>软件工程学习</a></p><p><a class="link" href="/posts/flask%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><span class="iconfont icon-article"></span>flask学习笔记</a></p></section></div></section><section id="footer"><div class="footer-wrap">
    <p class="copyright">比克王国</p>
    <p class="powerby"><span>Powered&nbsp;by&nbsp;</span><a href="https://gohugo.io" 
        target="_blank" rel="noopener noreferrer">Hugo</a><span>&nbsp;&amp;&nbsp;</span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank" rel="noopener noreferrer">Notepadium</a></p></div>
</section></body>

</html>